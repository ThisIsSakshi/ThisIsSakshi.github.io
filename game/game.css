:root{
  --pink:#ff4fa3;
  --pink2:#ff8ac7;
  --cream:#fff7fc;
  --violet:#7c4dff;
  --skyTop:#8be9ff;
  --skyBottom:#d7f7ff;
  --ambient:1;
  --ground1:#84cc16;
  --ground2:#6aa80f;
  --dark:#2c1830;
  --bottom-ui-gap:max(16px, env(safe-area-inset-bottom));
}

*{box-sizing:border-box}
html,body{margin:0;overscroll-behavior:none}
body{
  font-family:"Baloo 2",sans-serif;
  color:var(--dark);
  background:linear-gradient(180deg,#ffe4f3,#fff);
  overflow-x:hidden;
}

#sakura{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  pointer-events:none;
  z-index:0;
  opacity:.9;
  transition:opacity .25s ease;
}
body.hide-sakura #sakura{opacity:0}

.aurora{
  position:fixed;
  inset:-30%;
  z-index:-1;
  filter:blur(30px);
  background:
    radial-gradient(circle at 20% 30%, #ffb3da66 0 20%, transparent 35%),
    radial-gradient(circle at 70% 20%, #a994ff66 0 22%, transparent 40%),
    radial-gradient(circle at 50% 75%, #ffd0ea66 0 18%, transparent 35%);
  animation:drift 18s ease-in-out infinite alternate;
}
@keyframes drift{
  from{transform:translate(-2%,1%) scale(1)}
  to{transform:translate(2%,-1%) scale(1.08)}
}

.hud{
  position:sticky;
  top:0;
  z-index:20;
  display:grid;
  grid-template-columns:auto 1fr auto;
  gap:10px;
  align-items:center;
  padding:10px 14px;
  background:#fffdfed9;
  backdrop-filter:blur(6px);
  border-bottom:3px solid #ffd0e9;
}
.home-link{
  text-decoration:none;
  color:#5b4f87;
  font-weight:800;
}
.brand{
  justify-self:center;
  font-family:"Press Start 2P",cursive;
  color:var(--pink);
  font-size:12px;
}
.stats{
  display:flex;
  gap:14px;
  font-weight:800;
  font-size:18px;
}
.hud-tools{
  justify-self:end;
  display:flex;
  align-items:center;
  gap:10px;
}
.sound-btn{
  border:none;
  border-radius:999px;
  padding:8px 12px;
  font-family:"Baloo 2",sans-serif;
  font-weight:800;
  font-size:14px;
  color:#fff;
  background:linear-gradient(135deg,var(--pink),var(--pink2));
  box-shadow:0 8px 16px #ff5fa24a;
  cursor:pointer;
  white-space:nowrap;
}
.sound-btn.is-loading{
  color:#fdfbff;
  background:linear-gradient(135deg,#b9acc9,#a898bc);
  box-shadow:0 6px 12px #7c6f8d45;
  cursor:progress;
}
.sound-btn[aria-pressed="true"]{
  background:linear-gradient(135deg,#b4a8bf,#9988a8);
}

.layout{
  position:relative;
  z-index:1;
  max-width:1140px;
  margin:0 auto;
  padding:14px 14px calc(10px + var(--bottom-ui-gap));
}
.game-shell{
  background:#fff;
  border:4px solid #ffd7eb;
  border-radius:22px;
  padding:10px;
  box-shadow:0 18px 40px #ff57aa2b;
}
.viewport{
  position:relative;
  height:390px;
  overflow:hidden;
  border-radius:14px;
  border:3px solid #b6f0ff;
  background:linear-gradient(180deg,var(--skyTop),var(--skyBottom));
  touch-action:none;
}
.world{
  position:relative;
  width:4200px;
  height:100%;
  filter:brightness(var(--ambient));
}

.sky-layer{
  position:absolute;
  inset:0;
  background-repeat:repeat-x;
  pointer-events:none;
}
.clouds-a{
  background-image:
    radial-gradient(circle at 10% 20%,#ffffffaa 0 42px,transparent 43px),
    radial-gradient(circle at 30% 18%,#ffffffaa 0 32px,transparent 33px),
    radial-gradient(circle at 65% 22%,#ffffffaa 0 44px,transparent 45px),
    radial-gradient(circle at 85% 16%,#ffffffaa 0 36px,transparent 37px);
  background-size:900px 220px;
  animation:cloudMove 36s linear infinite;
}
.clouds-b{
  opacity:.6;
  background-image:
    radial-gradient(circle at 20% 42%,#fff 0 26px,transparent 27px),
    radial-gradient(circle at 55% 40%,#fff 0 30px,transparent 31px),
    radial-gradient(circle at 90% 46%,#fff 0 28px,transparent 29px);
  background-size:700px 260px;
  animation:cloudMove 52s linear infinite reverse;
}
@keyframes cloudMove{
  from{background-position:0 0}
  to{background-position:-900px 0}
}

.sparkles{
  position:absolute;
  inset:0;
  opacity:.45;
  background-image:
    radial-gradient(circle,#fff 0 2px,transparent 3px),
    radial-gradient(circle,#ffe8f6 0 2px,transparent 3px),
    radial-gradient(circle,#fff 0 1.5px,transparent 2px);
  background-size:120px 120px, 170px 170px, 230px 230px;
  animation:twinkle 6s ease-in-out infinite;
}
@keyframes twinkle{
  0%,100%{opacity:.32}
  50%{opacity:.75}
}

.hills{
  position:absolute;
  left:0;
  right:0;
  bottom:70px;
  height:140px;
  background:
    radial-gradient(circle at 10% 100%, #ffa0ce 0 100px, transparent 101px),
    radial-gradient(circle at 28% 100%, #b89dff 0 105px, transparent 106px),
    radial-gradient(circle at 53% 100%, #ffb6da 0 115px, transparent 116px),
    radial-gradient(circle at 79% 100%, #b89dff 0 108px, transparent 109px);
}
.ground{
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  height:72px;
  border-top:5px solid #4f7f0b;
  background:repeating-linear-gradient(90deg,var(--ground1) 0 36px,var(--ground2) 36px 72px);
}

.player{
  position:absolute;
  left:120px;
  bottom:72px;
  width:44px;
  height:56px;
  z-index:5;
  transform-origin:center bottom;
}
.player-sprite{
  width:100%;
  height:100%;
  border:3px solid #3e2344;
  border-radius:10px;
  background:linear-gradient(#ff86b6 0 18px,#ffe7f2 18px 36px,#8f63ff 36px);
  animation:idleBob .8s ease-in-out infinite alternate;
}
.player-sprite::before{
  content:"";
  position:absolute;
  margin:6px 0 0 7px;
  width:24px;
  height:8px;
  border-radius:6px;
  background:#fff;
}
.player-sprite.run{animation:runBounce .18s linear infinite alternate}
.player-sprite.jump{animation:jumpStretch .25s ease-out}
@keyframes idleBob{from{transform:translateY(0)}to{transform:translateY(-2px)}}
@keyframes runBounce{from{transform:translateY(0)}to{transform:translateY(-2px)}}
@keyframes jumpStretch{0%{transform:scale(1,1)}40%{transform:scale(.95,1.06)}100%{transform:scale(1,1)}}

.coin{
  position:absolute;
  bottom:155px;
  width:28px;
  height:28px;
  border-radius:50%;
  border:3px solid #9b6a00;
  background:radial-gradient(circle at 32% 28%,#fff6b0,#ffd76b 56%,#eda800);
  animation:coinSpin .9s linear infinite, coinFloat 1.1s ease-in-out infinite alternate;
}
@keyframes coinSpin{from{transform:rotateY(0)}to{transform:rotateY(360deg)}}
@keyframes coinFloat{from{translate:0 0}to{translate:0 -6px}}
.coin.collected{animation:coinPop .35s ease forwards}
@keyframes coinPop{
  0%{opacity:1; transform:scale(1)}
  100%{opacity:0; transform:translateY(-25px) scale(1.8)}
}

.pipe{
  position:absolute;
  bottom:72px;
  width:116px;
  height:126px;
  border:none;
  background:transparent;
  padding:0;
  cursor:pointer;
  isolation:isolate;
  animation:pipePulse 2.2s ease-in-out infinite;
}
.pipe::before,.pipe::after{
  content:"";
  position:absolute;
  left:50%;
  pointer-events:none;
}
.pipe-label{
  position:absolute;
  left:50%;
  bottom:2px;
  transform:translateX(-50%);
  min-width:90px;
  padding:6px 10px 5px;
  border-radius:999px;
  border:3px solid #8f5783;
  background:linear-gradient(180deg,#fffdfd,#ffe2f2);
  color:#5e2a54;
  font-family:"Press Start 2P",cursive;
  font-size:8px;
  line-height:1.2;
  text-align:center;
  box-shadow:0 5px 0 #f4bad7,0 8px 16px #4f2a5a26;
  text-shadow:0 1px 0 #fff;
}
.pipe[data-x="640"]{left:640px}
.pipe[data-x="1240"]{left:1240px}
.pipe[data-x="1840"]{left:1840px}
.pipe[data-x="2440"]{left:2440px}
.pipe[data-x="3040"]{left:3040px}
.pipe[data-x="3640"]{left:3640px}
.pipe.active{
  transform:translateY(-4px);
}
.pipe.active .pipe-label{
  border-color:#ff4fa3;
  color:#ff4fa3;
  box-shadow:0 6px 0 #ffb4dd,0 10px 18px #ff5fa24d;
}

.pipe-house::before{
  width:68px;
  height:52px;
  bottom:34px;
  transform:translateX(-50%);
  border:3px solid #7e4b3b;
  border-radius:10px;
  background:
    radial-gradient(circle,#6f4c3e 0 2px,transparent 2.5px) calc(50% + 5px) calc(100% - 14px)/6px 6px no-repeat,
    linear-gradient(#a56b4f,#8d553f) center calc(100% - 3px)/16px 24px no-repeat,
    linear-gradient(#dceefe,#dceefe) 12px 12px/16px 14px no-repeat,
    linear-gradient(#dceefe,#dceefe) calc(100% - 28px) 12px/16px 14px no-repeat,
    linear-gradient(180deg,#fff6d8,#ffe7bd);
  box-shadow:inset 0 -7px 0 #f6cc84;
}
.pipe-house::after{
  width:84px;
  height:44px;
  bottom:76px;
  transform:translateX(-50%);
  border:3px solid #8d3e5f;
  border-radius:4px;
  clip-path:polygon(50% 0,100% 100%,0 100%);
  background:
    linear-gradient(#cf8b6f,#cf8b6f) 17px 8px/10px 12px no-repeat,
    linear-gradient(180deg,#ff96c6,#ff5fa5);
}

.pipe-tree::before{
  width:22px;
  height:44px;
  bottom:38px;
  transform:translateX(-50%);
  border:3px solid #6d3f2e;
  border-radius:7px;
  background:linear-gradient(180deg,#b97b48,#8a512b);
}
.pipe-tree::after{
  width:84px;
  height:70px;
  bottom:64px;
  transform:translateX(-50%);
  border:3px solid #5b7e2a;
  border-radius:58% 42% 56% 44%/52% 46% 54% 48%;
  background:
    radial-gradient(circle at 35% 30%,#d8ffa4 0 24%,transparent 26%),
    radial-gradient(circle at 65% 25%,#b2eb6f 0 30%,transparent 31%),
    radial-gradient(circle at 50% 68%,#8bc646 0 56%,#73aa33 57% 100%);
}

.pipe-office::before{
  width:58px;
  height:68px;
  bottom:34px;
  transform:translateX(-50%);
  border:3px solid #4a5396;
  border-radius:8px;
  background:
    repeating-linear-gradient(90deg,#dff2ff 0 9px,#bde4ff 9px 16px),
    linear-gradient(180deg,#fef7ff,#d2cff9);
  box-shadow:inset 0 -10px 0 #a6a2e5;
}
.pipe-office::after{
  width:72px;
  height:20px;
  bottom:96px;
  transform:translateX(-50%);
  border:3px solid #656fb7;
  border-radius:10px;
  background:linear-gradient(180deg,#f7d6f0,#e7a6d9);
}

.pipe-lab::before{
  width:76px;
  height:44px;
  bottom:48px;
  transform:translateX(-50%);
  border:3px solid #355a6f;
  border-radius:9px;
  background:
    radial-gradient(circle at 28% 36%,#9ef2ff 0 18%,transparent 20%),
    radial-gradient(circle at 66% 58%,#70d7ff 0 22%,transparent 24%),
    linear-gradient(180deg,#dbf8ff,#9fd9f2);
}
.pipe-lab::after{
  width:64px;
  height:14px;
  bottom:34px;
  transform:translateX(-50%);
  border:3px solid #6b4f88;
  border-radius:999px;
  background:linear-gradient(180deg,#cdb5f4,#ad8be6);
}

.pipe-trophy::before{
  width:58px;
  height:52px;
  bottom:54px;
  transform:translateX(-50%);
  border:3px solid #9f6d00;
  border-radius:10px;
  clip-path:polygon(18% 0,82% 0,72% 68%,28% 68%);
  background:linear-gradient(180deg,#ffe790,#ffc743);
}
.pipe-trophy::after{
  width:38px;
  height:24px;
  bottom:34px;
  transform:translateX(-50%);
  border:3px solid #8b5b00;
  border-radius:8px;
  background:linear-gradient(180deg,#ffd569,#f4b32e);
  box-shadow:0 -18px 0 -6px #f9c54a;
}

.pipe-mail::before{
  width:58px;
  height:42px;
  bottom:44px;
  transform:translateX(-50%);
  border:3px solid #5e4c95;
  border-radius:10px;
  background:
    linear-gradient(135deg,transparent 0 48%,#efd9ff 49% 51%,transparent 52% 100%),
    linear-gradient(225deg,transparent 0 48%,#efd9ff 49% 51%,transparent 52% 100%),
    linear-gradient(180deg,#f8e9ff,#dbc0fb);
}
.pipe-mail::after{
  width:14px;
  height:48px;
  bottom:36px;
  transform:translateX(26px);
  border:3px solid #7e4f3a;
  border-radius:8px;
  background:
    linear-gradient(180deg,#b97b4b 0 72%,#ff5d9b 72% 100%);
}
@keyframes pipePulse{
  0%,100%{filter:brightness(1)}
  50%{filter:brightness(1.08)}
}

.controls{
  display:flex;
  gap:10px;
  justify-content:center;
  margin-top:12px;
}
.controls button,.btn{
  border:none;
  border-radius:12px;
  font-weight:800;
  color:#fff;
  background:linear-gradient(135deg,var(--pink),var(--pink2));
  box-shadow:0 8px 16px #ff5fa24a;
}
.controls button{
  min-width:72px;
  min-height:72px;
  font-size:26px;
}
.btn{
  display:inline-block;
  text-decoration:none;
  padding:10px 14px;
  margin-top:8px;
}

.panel{
  margin-top:14px;
  border:3px solid #ffd7eb;
  border-radius:18px;
  background:var(--cream);
  padding:14px;
  box-shadow:0 10px 30px #f48ccf21;
  transform:translateY(8px);
  opacity:.25;
  transition:.4s ease;
  max-height:none;
  overflow:visible;
}
.panel.active{
  transform:translateY(0);
  opacity:1;
}
.panel h2{
  margin:0 0 8px;
  font-size:30px;
  color:var(--violet);
}
.panel-body{display:grid;gap:12px}
.panel-body p{margin:0;font-size:17px;line-height:1.45}
.hero-card{
  border:2px solid #ffd6ea;
  border-radius:14px;
  padding:12px;
  background:linear-gradient(135deg,#fff,#ffe7f6);
}
.hero-name{margin:0;font-size:27px;color:#522d8a}
.hero-title{margin:4px 0 0;font-size:16px;color:#7a58b2;font-weight:800}
.meta-row{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.meta-pill{
  display:inline-block;
  padding:5px 10px;
  border-radius:999px;
  background:#f3e9ff;
  color:#63419b;
  font-weight:700;
  font-size:13px;
  border:1px solid #ddcbff;
}
.content-card{
  background:#fff;
  border:2px solid #ffe3f2;
  border-radius:14px;
  padding:12px;
  box-shadow:0 8px 18px #f8bde12b;
}
.content-card h4{margin:0 0 8px;font-size:20px;color:var(--violet)}
.card-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:8px;
}
.muted{margin:0 0 8px;font-size:14px;color:#8867b8;font-weight:700}
.chip-row{display:flex;flex-wrap:wrap;gap:8px}
.chip{
  display:inline-block;
  padding:5px 10px;
  border-radius:999px;
  background:#fff3d6;
  border:1px solid #f4d590;
  color:#7e5c1d;
  font-size:13px;
  font-weight:700;
}
.panel-list{margin:0;padding-left:19px;display:grid;gap:6px;font-size:16px;line-height:1.35}
.panel-list strong{display:inline-block}
.ach-date{
  margin-left:8px;
  display:inline-block;
  font-size:13px;
  font-weight:700;
  color:#8c74b3;
}
.ach-detail{
  margin-top:2px;
  font-size:13px;
  color:#8e5fa1;
}
.panel-links{display:flex;flex-wrap:wrap;gap:8px}
.panel-link{
  display:inline-block;
  text-decoration:none;
  padding:8px 12px;
  border-radius:10px;
  font-weight:800;
  color:#fff;
  background:linear-gradient(135deg,var(--pink),var(--pink2));
  box-shadow:0 8px 16px #ff5fa24a;
}
.panel-link:hover{transform:translateY(-1px)}
.panel::-webkit-scrollbar{width:10px}
.panel::-webkit-scrollbar-thumb{
  border-radius:999px;
  background:linear-gradient(var(--pink2),var(--pink));
  border:2px solid #fff7fc;
}

@media (min-width:861px){
  .controls{display:none}
}
@media (max-width:860px){
  .brand{font-size:10px}
  .stats{font-size:15px}
  .hud-tools{gap:6px}
  .sound-btn{font-size:12px;padding:7px 10px}
  .layout{padding-bottom:calc(12px + var(--bottom-ui-gap))}
  .viewport{height:min(340px, 48dvh)}
  .panel{max-height:none;overflow:visible}
  .hero-name{font-size:22px}
  .content-card h4{font-size:18px}
  .panel-body p{font-size:16px}
}

@media (max-height:760px){
  .viewport{height:min(320px, 42dvh)}
  .panel{max-height:none}
}
